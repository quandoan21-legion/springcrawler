<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Category crawler</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>
<div class="container">
    <h1>Source crawling test</h1>

    <form th:action="@{/admin/crawl}" method="post" class="edit-form">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <div th:if="${error}" class="error" th:text="${error}"
         style="color:#ff6b6b;text-align:center;margin-bottom:15px;"></div>
    <div th:if="${message}" class="success" th:text="${message}"
         style="color:#6bff8f;text-align:center;margin-bottom:15px;"></div>

        <div class="form-group">
            <label for="sourceId">Select source (by category)</label>
            <select id="sourceId" name="sourceId" required>
                <option value="" disabled th:selected="${selectedSourceId == null}">-- Select source --</option>
                <option th:each="source : ${sources}"
                        th:value="${source.id}"
                        th:text="${source.category != null ? source.category.name + ' - ' + source.url : source.url}"
                        th:selected="${selectedSourceId != null} ? (selectedSourceId == source.id) : false">
                </option>
            </select>
        </div>



        <div class="button-container">
            <button type="submit" class="btn-save">Start crawling</button>
            <button type="button"
                    class="btn-save btn-secondary"
                    onclick="document.getElementById('get-uncrawl-form').submit();">Get UNCRAWL posts</button>
            <a th:href="@{/admin}" class="btn-back-link">Back to admin</a>
        </div>
    </form>

    <form id="get-uncrawl-form" th:action="@{/admin/crawl/get-uncrawl-posts}" method="post" style="display:none;">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    </form>

    <div th:if="${links != null}">
        <h2>Results</h2>
        <p th:if="${sourceUrl}" th:text="'Source: ' + ${sourceUrl}" style="margin-bottom:10px;"></p>
        <p th:if="${links.size() == 0}">No matching links were found.</p>
        <ul th:if="${links.size() > 0}">
            <li th:each="link : ${links}">
                <a th:href="${link}" th:text="${link}" target="_blank" style="color:#4f8ef7;"></a>
            </li>
        </ul>
    </div>
</div>
</body>
</html>
